from math import gcd, sqrt
from random import randint

def rho_pollard(n):
	f = lambda x:(x**2 + 1) % n
	x1 = randint(2, n-1)
	x2 = f(x1)
	while True:
		x1 = f(x1)		# x2
		x2 = f(f(x2))	# x4
		g = gcd(x2-x1, n)
		if g != 1:
			return g

def rho_pollard_bench(n):
    f = lambda x:(x**2 + 1) % n
    x1 = randint(2, n-1)
    x2 = f(x1)
    s = 0 # liczba krok√≥w
    while True:
        x1 = f(x1)		# x2
        x2 = f(f(x2))	# x4
        g = gcd(x2-x1, n)
        s += 1
        if g != 1:
            return g, s

def benchmark(data, N = 100):
    for a in data:
        avg = 0
        r = 0
        for _ in range(N):
            r, s = rho_pollard_bench(a)
            avg += s
        avg = avg / N
        print(a, avg, sqrt(r))

# liczby pierwsze
# data = (1872929, 1367857, 1872527, 1801, 60293, 47881, 27407, 3253, 8431, 4957, 80671, 66029, 42307,
# 84827, 73721, 58693, 99191, 6911, 85691, 58787, 69379, 80779, 87221,
# 24953, 57881, 42683, 16889, 70297, 51047, 89917, 83773, 39503, 3691,
# 33223, 85429, 8209, 39373, 82891, 89779, 40169, 65657, 28909, 27779)

# data = (1872929, 1367857, 1872527, 1801, 60293, 47881, 27407, 3253, 8431, 4957, 80671, 66029, 42307,
# 84827, 73721, 58693, 99191, 6911, 85691, 58787, 69379, 80779, 87221,
# 24953, 57881, 42683, 16889, 70297, 51047, 89917, 83773, 39503, 3691,
# 33223, 85429, 8209, 39373, 82891, 89779, 40169, 65657, 28909, 27779,
# 17987, 79609, 67211, 95923, 28349, 65599, 41243, 57571, 44129, 72173,
# 12101, 61561, 84503, 43853, 84191, 19543, 12281, 2243, 90911, 55079,
# 4637, 5849, 84701, 11083, 73483, 82189, 46381, 1373, 69779, 2521)

# data = (50087, 5507, 43781, 50387, 92221, 67141, 65033, 29311, 57287, 25847, 80363, 28387, 37889, 311, 41221, 74861, 76631, 4969, 97379, 56369, 8467, 93377, 81769, 45181, 14593, 59417, 1559, 27779, 75407, 94099, 73433, 52237, 29333, 19207, 29837, 32833, 51719, 76883, 27967, 38977, 509, 10723, 66041, 86381, 18617, 3319, 26203, 99643, 57223, 69341, 27277, 7309, 71059, 58369, 91771, 72421, 57259, 55171, 62233, 71317, 33119, 71411, 80909, 89431, 38629, 13859, 40543, 55339, 26669, 84811, 76379, 68371, 68239, 85781, 62039, 22531, 53239, 76543, 6113, 69859, 5501, 43973, 33827, 33829, 12409, 29383, 51059, 38303, 42643, 3119, 48017, 70957, 79829, 43573, 27809, 30119, 45361, 25097, 54919, 76369)

data = (13537, 93827, 61153, 73709, 55663, 75743, 29347, 82529, 9859, 51913, 37313, 55793, 89797, 87037, 65519, 84299, 91583, 15053, 87701, 66943, 62761, 14657, 33083, 27893, 51829, 26003, 48767, 6473, 13691, 33713, 50497, 77137, 40927, 3677, 57041, 80809, 95003, 9781, 17851, 75239, 92317, 85363, 73859, 69191, 51659, 14563, 37019, 32869, 45979, 211, 3943, 58913, 34939, 12347, 72337, 12037, 22783, 21493, 18517, 23057, 16871, 69197, 59209, 57653, 52529, 27961, 92623, 29683, 33773, 70793, 113, 4201, 33049, 84673, 60217, 95989, 91457, 88411, 90679, 74021, 19961, 16529, 32801, 19001, 96989, 66029, 52453, 73727, 41227, 26539, 5801, 47111, 10333, 72871, 97613, 1399, 11777, 39139, 7669, 35521, 25183, 22123, 39791, 84263, 6607, 66851, 35317, 11411, 42841, 49681, 71329, 66071, 49117, 77471, 5623, 12799, 17327, 15289, 37361, 17939, 10739, 71569, 23027, 2521, 46049, 78607, 29867, 54371, 37223, 1697, 20479, 86719, 23609, 75979, 34981, 57737, 2791, 9733, 68501, 62851, 21773, 58147, 23189, 34511, 65963, 67289, 12377, 43133, 29663, 63761, 10313, 42577, 39953, 9209, 25463, 71261, 59417, 30949, 82223, 65119, 35089, 6679, 20719, 30707, 59561, 35393, 33151, 17467, 74551, 50891, 36551, 9467, 44131, 41843, 54629, 76487, 30841, 26669, 79349, 76883, 77713, 61091, 30253, 64279, 80491, 36947, 14779, 22283, 8009, 64007, 87071, 39521, 27697, 10499, 20879, 93377, 47779, 47563, 11953, 67061, 80363, 35603, 80273, 74771, 77743, 58481, 74521, 71023, 47251, 81967, 58453, 76543, 38543, 82903, 31963, 58967, 75991, 3637, 56453, 57487, 90511, 29033, 40471, 33923, 1873, 2887, 9221, 25667, 77249, 61979, 58271, 97003, 42937, 15937, 71387, 75967, 98717, 3259, 38629, 65677, 50111, 17921, 52543, 3967, 75989, 3581, 72647, 18661, 79063, 67369, 53623, 95231, 32971, 17401, 71143, 31307, 68141, 91837, 65393, 71807, 46933, 85621, 14387, 36263, 93383, 54151, 26627, 36749, 5303, 99401, 31607, 4259, 11497, 96779, 16453, 26119, 87679, 29851, 4327, 27527, 35281, 14533, 54181, 3769, 28879, 88523, 58771, 53069, 61717, 6689, 45691, 47717, 60661, 28837, 19507, 82793, 241, 48623, 7237, 90199, 90289, 27437, 50053, 70183, 91841, 80779, 1627, 91499, 7591, 5227, 46327, 67819, 90247, 9161, 49069, 49663, 40591, 92809, 37003, 23159, 60937, 85361, 82171, 30971, 86029, 54721, 55799, 76163, 27409, 2287, 30559, 27067, 29669, 24203, 17863, 22901, 32749, 10399, 94063, 58601, 30983, 78101, 7937, 18461, 66931, 24763, 87797, 48733, 28429, 91753, 18671, 70571, 13709, 5501, 51047, 42023, 23371, 85733, 65407, 95093, 10487, 49831, 77557, 49193, 96587, 89627, 69067, 82531, 11471, 10663, 74323, 90127, 65447, 42853, 21391, 2897, 29429, 19727, 659, 80557, 94903, 11437, 47297, 22639, 50821, 72707, 61967, 19843, 13121, 6091, 85447, 10657, 45533, 77417, 65729, 57269, 66809, 89477, 2089, 7211, 44453, 93559, 41177, 46103, 673, 93887, 47527, 4523, 93329, 42709, 37573, 11423, 3583, 78509, 25997, 65381, 55927, 57637, 64153, 63397, 30241, 20389, 8053, 91229, 96443, 1811, 55823, 77479, 25237, 97073, 41959, 80677, 39079, 87257, 96973, 44939, 77017, 35363, 34667, 23357, 4639, 56417, 45827, 39451, 26723, 58243, 47969, 56123, 69623, 72073, 76103, 34747, 58237, 41081, 23911, 45281, 87221, 44017, 821, 13159, 52181, 98369, 24023, 36691, 18443, 57809, 21577, 14639, 6619, 85999, 8819, 34261, 88813, 72997, 181, 76283, 27647, 71287, 63097, 46549, 41593, 17987, 3079, 94463, 56383, 47777, 63103, 71191, 36563, 51109, 26959, 6037, 99907, 8269, 75731, 47533, 67939, 28789, 35053, 12917, 55051, 11633, 8867, 25849, 28711, 97397, 9619, 6863, 19597, 92219, 36857, 93901, 92671, 70199, 84503, 20963, 61681, 63803, 61409, 81331, 88469, 20369, 44963, 14851, 93761, 95527, 52973, 9341, 17389, 41521, 94307, 86413, 47041, 82013, 70529, 15767, 63079, 32839, 89519, 13241, 85667, 26317, 49409, 80747, 32621, 86677, 66343, 10271, 19477, 80669, 40031, 32531, 51673, 91081, 52057, 86927, 62581, 15493, 30347, 90271, 45013, 47389, 34381, 17123, 60631, 95429, 3061, 40163, 11131, 24533, 24551, 6173, 75617, 26347, 29921, 69001, 11311, 32369, 66361, 50291, 66797, 48121, 67157, 96259, 69127, 1249, 47017, 81023, 12853, 78163, 20129, 67189, 35423, 63689, 1579, 97583, 4969, 22543, 26947, 75347, 90017, 42323, 9851, 88807, 7817, 17207, 84317, 40289, 32909, 26297, 81749, 6599, 63997, 38183, 53719, 89413, 36061, 10067, 2713, 61297, 41597, 90197, 84731, 41413, 30133, 24083, 38393, 39733, 61819, 19489, 4271, 11329, 51787, 28307, 57559, 71941, 81013, 56087, 43789, 90821, 1307, 93281, 39541, 25303, 33503, 76801, 82633, 28933, 1289, 15319, 61637, 36739, 14731, 5581, 94441, 15187, 83987, 75401, 65699, 38377, 87751, 17909, 25219, 16067, 9587, 1303, 95701, 48817, 90911, 4289, 16427, 46061, 26693, 20981, 93251, 52387, 46639, 2657, 17291, 92801, 75289, 61631, 7583, 443, 15401, 63211, 85331, 76537, 83227, 38449, 75767, 30937, 36721, 23087, 68881, 14519, 66499, 32653, 17159, 65293, 31387, 68947, 91513, 34841, 6211, 21377, 13721, 4933, 78779, 96013, 28661, 81707, 84719, 69457, 28607, 55837, 56999, 31687, 37987, 69073, 87083, 35027, 64217, 69427, 64189, 12647, 41647, 4729, 56893, 53549, 25621, 95177, 51437, 17377, 12451, 63601, 59723, 28867, 40037, 52901, 41039, 54409, 68227, 68777, 9463, 21407, 73361, 66509, 75583, 29917, 56929, 52583, 43201, 40529, 74653, 18583, 68207, 70951, 32141, 38561, 66883, 44371, 48079, 95957, 5101, 93523, 87553, 70769, 58313, 8069, 96997, 20051, 81883, 3547, 91249, 40237, 44501, 91393, 3877, 51071, 4241, 77093, 76733, 54293, 59791, 2707, 50423, 54469, 49103, 39443, 86627, 23633, 97729, 47681, 16729, 77813, 78283, 73679, 27701, 92243, 32303, 22447, 1237, 82207, 43787, 1543, 5857, 3691, 6113, 20341, 1801, 87911, 21727, 41057, 88607, 33703, 87539, 85159, 22651, 52021, 7507, 12253, 4447, 95267, 74311, 77617, 24943, 17623, 43397, 3181, 19819, 44119, 68791, 16619, 4231, 31727, 58943, 5413, 53149, 50221, 82183, 98221, 99607, 70177, 63521, 1571, 35323, 85061, 55933, 87323, 29411, 14197, 31891, 839, 80287, 32341, 74071, 10559, 72671, 56081, 50543, 84751, 47353, 3137, 77867, 26759, 56473, 24593, 97501, 92203, 49363, 1777, 60901, 9043, 91811, 95101, 62987, 71551, 37699, 8429, 36943, 30097, 91139, 7393, 84653, 80629, 19841, 32933, 18251, 22259, 2297, 96731, 65521, 37831, 48821, 49261, 63671, 89057, 75983, 92269, 69691, 8039, 81181, 28447, 22501, 75367, 38113, 96553, 98507, 24767, 27883, 55079, 27791, 78179, 48163, 61553, 59419, 15971, 34499, 99257, 72313, 68261, 24809, 89399, 87641, 77171, 56993, 23039, 66977, 42751, 46619, 68483, 20011, 80191, 16993, 24109, 3049, 28229, 34757, 80683, 32957, 17573, 90217, 70079, 5119, 76253, 97961, 8963, 63353, 78569, 70949, 70141, 23719, 16903, 25307, 51169, 84991, 13669, 8969, 85607, 65029, 67933, 78203, 32203, 32563, 9629, 52627, 23833, 2957, 49559, 21011, 47087, 40849, 24371, 44657, 96053, 82499, 33343, 66359, 16573, 25457, 2659, 32833, 29527, 24971, 26833, 8527, 99487, 33211, 63113, 58099, 43207, 68899, 57467, 71563, 24061, 62383, 48527, 37199, 20663)

# liczby losowe
# data2 = [randint(100, 10000000) for _ in range(100)]
data2 = [randint(100, 10000) for _ in range(1000)]

benchmark(data, 10000)
# benchmark(data2, 10000)

# n = 1691991

# print(rho_pollard(n))



